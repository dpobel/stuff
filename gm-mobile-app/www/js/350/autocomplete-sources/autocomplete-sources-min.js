YUI.add("autocomplete-sources",function(f){var l=f.AutoCompleteBase,k=f.Lang,i="_sourceSuccess",m="maxResults";f.mix(l.prototype,{_YQL_SOURCE_REGEX:/^(?:select|set|use)\s+/i,_beforeCreateObjectSource:function(a){return a instanceof f.Node&&"select"===a.get("nodeName").toLowerCase()?this._createSelectSource(a):f.JSONPRequest&&a instanceof f.JSONPRequest?this._createJSONPSource(a):this._createObjectSource(a)},_createIOSource:function(a){function d(b){var d=b.request;if(c._cache&&d in c._cache)c[i](c._cache[d],
b);else e&&e.isInProgress()&&e.abort(),e=f.io(c._getXHRUrl(a,b),{on:{success:function(a,e){var g;try{g=f.JSON.parse(e.responseText)}catch(h){f.error("JSON parse error",h)}g&&(c._cache&&(c._cache[d]=g),c[i](g,b))}}})}var b={type:"io"},c=this,e,h,g;b.sendRequest=function(a){h=a;g||(g=!0,f.use("io-base","json-parse",function(){b.sendRequest=d;d(h)}))};return b},_createJSONPSource:function(a){function d(b){var e=b.request,d=b.query;if(c._cache&&e in c._cache)c[i](c._cache[e],b);else a._config.on.success=
function(a){c._cache&&(c._cache[e]=a);c[i](a,b)},a.send(d)}var b={type:"jsonp"},c=this,e,h;b.sendRequest=function(g){e=g;h||(h=!0,f.use("jsonp",function(){a instanceof f.JSONPRequest||(a=new f.JSONPRequest(a,{format:f.bind(c._jsonpFormatter,c)}));b.sendRequest=d;d(e)}))};return b},_createSelectSource:function(a){var d=this;return{type:"select",sendRequest:function(b){var c=[];a.get("options").each(function(a){c.push({html:a.get("innerHTML"),index:a.get("index"),node:a,selected:a.get("selected"),text:a.get("text"),
value:a.get("value")})});d[i](c,b)}}},_createStringSource:function(a){return this._YQL_SOURCE_REGEX.test(a)?this._createYQLSource(a):-1!==a.indexOf("{callback}")?this._createJSONPSource(a):this._createIOSource(a)},_createYQLSource:function(a){function d(c){var d=c.query,e=b.get("yqlEnv"),h=b.get(m),j;j=k.sub(a,{maxResults:0<h?h:1E3,request:c.request,query:d});if(b._cache&&j in b._cache)b[i](b._cache[j],c);else d=function(a){b._cache&&(b._cache[j]=a);b[i](a,c)},h={proto:b.get("yqlProtocol")},g?(g._callback=
d,g._opts=h,g._params.q=j,e&&(g._params.env=e)):g=new f.YQLRequest(j,{on:{success:d},allowCache:!1},e?{env:e}:null,h),g.send()}var b=this,c={type:"yql"},e,h,g;b.get("resultListLocator")||b.set("resultListLocator",b._defaultYQLLocator);c.sendRequest=function(a){e=a;h||(h=!0,f.use("yql",function(){c.sendRequest=d;d(e)}))};return c},_defaultYQLLocator:function(a){(a=a&&a.query&&a.query.results)&&k.isObject(a)?(a=f.Object.values(a)||[],a=1===a.length?a[0]:a,k.isArray(a)||(a=[a])):a=[];return a},_getXHRUrl:function(a,
d){var b=this.get(m);d.query!==d.request&&(a+=d.request);return k.sub(a,{maxResults:0<b?b:1E3,query:encodeURIComponent(d.query)})},_jsonpFormatter:function(a,d,b){var c=this.get(m),e=this.get("requestTemplate");e&&(a+=e(b));return k.sub(a,{callback:d,maxResults:0<c?c:1E3,query:encodeURIComponent(b)})}});f.mix(l.ATTRS,{yqlEnv:{value:null},yqlProtocol:{value:"http"}});f.mix(l.SOURCE_TYPES,{io:"_createIOSource",jsonp:"_createJSONPSource",object:"_beforeCreateObjectSource",select:"_createSelectSource",
string:"_createStringSource",yql:"_createYQLSource"},!0)},"3.5.0",{requires:["autocomplete-base"],optional:["io-base","json-parse","jsonp","yql"]});
