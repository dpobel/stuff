YUI.add("widget-position-constrain",function(g){function h(){this._posNode||g.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added");g.after(this._bindUIPosConstrained,this,n)}var n="bindUI",l=g.Node,m;h.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}};m=h._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}};h.prototype={getConstrainedXY:function(a,b){var b=b||this.get("constrain"),d=this._getRegion(!0===
b?null:b),c=this._posNode.get("region");return[this._constrain(a[0],"x",c,d),this._constrain(a[1],"y",c,d)]},constrain:function(a,b){var d,c;if(c=b||this.get("constrain"))d=a||this.get("xy"),c=this.getConstrainedXY(d,c),(c[0]!==d[0]||c[1]!==d[1])&&this.set("xy",c,{constrained:!0})},_setConstrain:function(a){return!0===a?a:l.one(a)},_constrain:function(a,b,d,c){if(c){this.get("preventOverlap")&&(a=this._preventOverlap(a,b,d,c));var f="x"==b,b=f?c.width:c.height,d=f?d.width:d.height,e=f?c.left:c.top,
c=f?c.right-d:c.bottom-d;if(a<e||a>c)d<b?a<e?a=e:a>c&&(a=c):a=e}return a},_preventOverlap:function(a,b,d,c){var f=this.get("align"),e="x"===b,i,g,h,j,k;if(f&&f.points&&m[b][f.points.join("")]){if(b=this._getRegion(f.node))i=e?d.width:d.height,g=e?b.left:b.top,h=e?b.right:b.bottom,j=e?b.left-c.left:b.top-c.top,k=e?c.right-b.right:c.bottom-b.bottom;a>g?k<i&&j>i&&(a=g-i):j<i&&k>i&&(a=h)}return a},_bindUIPosConstrained:function(){this.after("constrainChange",this._afterConstrainChange);this._enableConstraints(this.get("constrain"))},
_afterConstrainChange:function(a){this._enableConstraints(a.newVal)},_enableConstraints:function(a){a?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on("constrain|xyChange",this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(a){a.constrained||(a.newVal=this.getConstrainedXY(a.newVal))},_getRegion:function(a){var b;a?(a=l.one(a))&&(b=a.get("region")):b=this._posNode.get("viewportRegion");return b}};g.WidgetPositionConstrain=
h},"3.5.0",{requires:["widget-position"]});
