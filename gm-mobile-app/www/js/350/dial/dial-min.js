YUI.add("dial",function(c){function b(a){b.superclass.constructor.apply(this,arguments)}function d(a){return c.ClassNameManager.getClassName(b.NAME,a)}var g=!1;c.UA.ie&&9>c.UA.ie&&(g=!0);var i=c.Lang,j=c.Widget,h=c.Node;b.NAME="dial";b.ATTRS={min:{value:-220},max:{value:220},diameter:{value:100},handleDiameter:{value:0.2},markerDiameter:{value:0.1},centerButtonDiameter:{value:0.5},value:{value:0,validator:function(a){return this._validateValue(a)}},minorStep:{value:1},majorStep:{value:10},stepsPerRevolution:{value:100},
decimalPlaces:{value:0},strings:{valueFn:function(){return c.Intl.get("dial")}},handleDistance:{value:0.75}};b.CSS_CLASSES={label:d("label"),labelString:d("label-string"),valueString:d("value-string"),northMark:d("north-mark"),ring:d("ring"),ringVml:d("ring-vml"),marker:d("marker"),markerVml:d("marker-vml"),markerMaxMin:d("marker-max-min"),centerButton:d("center-button"),centerButtonVml:d("center-button-vml"),resetString:d("reset-string"),handle:d("handle"),handleVml:d("handle-vml"),hidden:d("hidden"),
dragging:c.ClassNameManager.getClassName("dd-dragging")};b.LABEL_TEMPLATE='<div class="'+b.CSS_CLASSES.label+'"><span id="" class="'+b.CSS_CLASSES.labelString+'">{label}</span><span class="'+b.CSS_CLASSES.valueString+'"></span></div>';!1===g?(b.RING_TEMPLATE='<div class="'+b.CSS_CLASSES.ring+'"><div class="'+b.CSS_CLASSES.northMark+'"></div></div>',b.MARKER_TEMPLATE='<div class="'+b.CSS_CLASSES.marker+" "+b.CSS_CLASSES.hidden+'"></div>',b.CENTER_BUTTON_TEMPLATE='<div class="'+b.CSS_CLASSES.centerButton+
'"><div class="'+b.CSS_CLASSES.resetString+" "+b.CSS_CLASSES.hidden+'">{resetStr}</div></div>',b.HANDLE_TEMPLATE='<div class="'+b.CSS_CLASSES.handle+'" aria-labelledby="" aria-valuetext="" aria-valuemax="" aria-valuemin="" aria-valuenow="" role="slider"  tabindex="0" title="{tooltipHandle}">'):(b.RING_TEMPLATE='<div class="'+b.CSS_CLASSES.ring+" "+b.CSS_CLASSES.ringVml+'"><div class="'+b.CSS_CLASSES.northMark+'"></div><v:oval strokecolor="#ceccc0" strokeweight="1px"><v:fill type=gradient color="#8B8A7F" color2="#EDEDEB" angle="45"/></v:oval></div>',
b.MARKER_TEMPLATE='<div class="'+b.CSS_CLASSES.markerVml+" "+b.CSS_CLASSES.hidden+'"><v:oval stroked="false"><v:fill opacity="20%" color="#000"/></v:oval></div>',b.CENTER_BUTTON_TEMPLATE='<div class="'+b.CSS_CLASSES.centerButton+" "+b.CSS_CLASSES.centerButtonVml+'"><v:oval strokecolor="#ceccc0" strokeweight="1px"><v:fill type=gradient color="#C7C5B9" color2="#fefcf6" colors="35% #d9d7cb, 65% #fefcf6" angle="45"/><v:shadow on="True" color="#000" opacity="10%" offset="2px, 2px"/></v:oval><div class="'+
b.CSS_CLASSES.resetString+" "+b.CSS_CLASSES.hidden+'">{resetStr}</div></div>',b.HANDLE_TEMPLATE='<div class="'+b.CSS_CLASSES.handleVml+'" aria-labelledby="" aria-valuetext="" aria-valuemax="" aria-valuemin="" aria-valuenow="" role="slider"  tabindex="0" title="{tooltipHandle}"><v:oval stroked="false"><v:fill opacity="20%" color="#6C3A3A"/></v:oval></div>');c.extend(b,j,{renderUI:function(){this._renderLabel();this._renderRing();this._renderMarker();this._renderCenterButton();this._renderHandle();
this.contentBox=this.get("contentBox");this._originalValue=this.get("value");this._minValue=this.get("min");this._maxValue=this.get("max");this._stepsPerRevolution=this.get("stepsPerRevolution");this._minTimesWrapped=Math.floor(this._minValue/this._stepsPerRevolution-1);this._maxTimesWrapped=Math.floor(this._maxValue/this._stepsPerRevolution+1);this._timesWrapped=0;this._prevAng=this._angle=this._getAngleFromValue(this.get("value"));this._setTimesWrappedFromValue(this._originalValue);this._handleNode.set("aria-valuemin",
this._minValue);this._handleNode.set("aria-valuemax",this._maxValue)},_setBorderRadius:function(){this._ringNode.setStyles({WebkitBorderRadius:this._ringNodeRadius+"px",MozBorderRadius:this._ringNodeRadius+"px",borderRadius:this._ringNodeRadius+"px"});this._handleNode.setStyles({WebkitBorderRadius:this._handleNodeRadius+"px",MozBorderRadius:this._handleNodeRadius+"px",borderRadius:this._handleNodeRadius+"px"});this._markerNode.setStyles({WebkitBorderRadius:this._markerNodeRadius+"px",MozBorderRadius:this._markerNodeRadius+
"px",borderRadius:this._markerNodeRadius+"px"});this._centerButtonNode.setStyles({WebkitBorderRadius:this._centerButtonNodeRadius+"px",MozBorderRadius:this._centerButtonNodeRadius+"px",borderRadius:this._centerButtonNodeRadius+"px"})},_handleCenterButtonEnter:function(){this._resetString.removeClass(b.CSS_CLASSES.hidden)},_handleCenterButtonLeave:function(){this._resetString.addClass(b.CSS_CLASSES.hidden)},bindUI:function(){this.after("valueChange",this._afterValueChange);var a=this.get("boundingBox"),
b=!c.UA.opera?"down:":"press:",f=b+"37,39",e=b+"37+meta,39+meta";c.on("key",c.bind(this._onDirectionKey,this),a,b+"38,40,33,34,35,36");c.on("key",c.bind(this._onLeftRightKey,this),a,f);a.on("key",this._onLeftRightKeyMeta,e,this);c.on("mouseenter",c.bind(this._handleCenterButtonEnter,this),this._centerButtonNode);c.on("mouseleave",c.bind(this._handleCenterButtonLeave,this),this._centerButtonNode);c.on("gesturemovestart",c.bind(this._resetDial,this),this._centerButtonNode);c.on("gesturemoveend",c.bind(this._handleCenterButtonMouseup,
this),this._centerButtonNode);c.on("gesturemovestart",c.bind(this._handleHandleMousedown,this),this._handleNode);c.on("gesturemovestart",c.bind(this._handleMousedown,this),this._ringNode);c.on("gesturemoveend",c.bind(this._handleRingMouseup,this),this._ringNode);this._dd1=new c.DD.Drag({node:this._handleNode,on:{"drag:drag":c.bind(this._handleDrag,this),"drag:start":c.bind(this._handleDragStart,this),"drag:end":c.bind(this._handleDragEnd,this)}});c.bind(this._dd1.addHandle(this._ringNode),this)},
_setTimesWrappedFromValue:function(a){this._timesWrapped=a%this._stepsPerRevolution===0?a/this._stepsPerRevolution:Math.floor(a/this._stepsPerRevolution)},_getAngleFromHandleCenter:function(a,b){var c=Math.atan((this._dialCenterY-b)/(this._dialCenterX-a))*(180/Math.PI);return c=this._dialCenterX-a<0?c+90:c+90+180},_calculateDialCenter:function(){this._dialCenterX=this._ringNode.get("offsetWidth")/2;this._dialCenterY=this._ringNode.get("offsetHeight")/2},_handleRingMouseup:function(){this._handleNode.focus()},
_handleCenterButtonMouseup:function(){this._handleNode.focus()},_handleHandleMousedown:function(){this._handleNode.focus()},_handleDrag:function(a){var b,c;b=parseInt(this._handleNode.getStyle("left"),10)+this._handleNodeRadius;c=parseInt(this._handleNode.getStyle("top"),10)+this._handleNodeRadius;b=this._getAngleFromHandleCenter(b,c);if(this._prevAng>270&&b<90){if(this._timesWrapped<this._maxTimesWrapped)this._timesWrapped=this._timesWrapped+1}else if(this._prevAng<90&&b>270&&this._timesWrapped>
this._minTimesWrapped)this._timesWrapped=this._timesWrapped-1;c=this._getValueFromAngle(b);c>this._maxValue+this._stepsPerRevolution?this._timesWrapped--:c<this._minValue-this._stepsPerRevolution&&this._timesWrapped++;this._prevAng=b;this._handleValuesBeyondMinMax(a,c)},_handleMousedown:function(a){var b=this._getAngleFromValue(this._minValue),f=this._getAngleFromValue(this._maxValue),e,d;if(c.UA.ios){e=a.clientX-this._ringNode.getX();d=a.clientY-this._ringNode.getY()}else{e=a.clientX+c.one("document").get("scrollLeft")-
this._ringNode.getX();d=a.clientY+c.one("document").get("scrollTop")-this._ringNode.getY()}e=this._getAngleFromHandleCenter(e,d);if(this._maxValue-this._minValue>this._stepsPerRevolution)if(Math.abs(this._prevAng-e)>180){if(this._timesWrapped>this._minTimesWrapped&&this._timesWrapped<this._maxTimesWrapped)this._timesWrapped=this._prevAng-e>0?this._timesWrapped+1:this._timesWrapped-1}else this._timesWrapped===this._minTimesWrapped&&e-this._prevAng<180&&this._timesWrapped++;else if(this._maxValue-this._minValue===
this._stepsPerRevolution)this._timesWrapped=e<b?1:0;else if(b>f)this._prevAng>=b&&e<=(b+f)/2?this._timesWrapped++:this._prevAng<=f&&e>(b+f)/2&&this._timesWrapped--;else if(e<b||e>f){a=((b+f)/2+180)%360;b=a>180?f<e&&e<a?this.get("max"):this.get("min"):b>e&&e>a?this.get("min"):this.get("max");this._prevAng=this._getAngleFromValue(b);this.set("value",b);this._setTimesWrappedFromValue(b);return}b=this._getValueFromAngle(e);this._prevAng=e;this._handleValuesBeyondMinMax(a,b)},_handleValuesBeyondMinMax:function(a,
b){if(b>=this._minValue&&b<=this._maxValue){this.set("value",b);a.currentTarget===this._ringNode&&this._dd1._handleMouseDownEvent(a)}else if(b>this._maxValue){this.set("value",this._maxValue);if(a.type==="gesturemovestart")this._prevAng=this._getAngleFromValue(this._maxValue)}else if(b<this._minValue){this.set("value",this._minValue);if(a.type==="gesturemovestart")this._prevAng=this._getAngleFromValue(this._minValue)}},_handleDragStart:function(){this._markerNode.removeClass(b.CSS_CLASSES.hidden)},
_handleDragEnd:function(){this._handleNode.transition({duration:0.08,easing:"ease-in",left:this._setNodeToFixedRadius(this._handleNode,true)[0]+"px",top:this._setNodeToFixedRadius(this._handleNode,true)[1]+"px"},c.bind(function(){var a=this.get("value");if(a>this._minValue&&a<this._maxValue)this._markerNode.addClass(b.CSS_CLASSES.hidden);else{this._setTimesWrappedFromValue(a);this._prevAng=this._getAngleFromValue(a)}},this))},_setNodeToFixedRadius:function(a,b){var c=this._angle-90,e=Math.PI/180,
d=Math.round(Math.sin(c*e)*this._handleDistance),c=Math.round(Math.cos(c*e)*this._handleDistance),e=a.get("offsetWidth"),d=d-e*0.5,c=c-e*0.5;if(b)return[this._ringNodeRadius+c,this._ringNodeRadius+d];a.setStyle("left",this._ringNodeRadius+c+"px");a.setStyle("top",this._ringNodeRadius+d+"px")},syncUI:function(){this._setSizes();this._calculateDialCenter();this._setBorderRadius();this._uiSetValue(this.get("value"));this._markerNode.addClass(b.CSS_CLASSES.hidden);this._resetString.addClass(b.CSS_CLASSES.hidden)},
_setSizes:function(){var a=this.get("diameter"),b;b=function(a,b,c){a.getElementsByTagName("oval").setStyle("width",b*c+"px");a.getElementsByTagName("oval").setStyle("height",b*c+"px");a.setStyle("width",b*c+"px");a.setStyle("height",b*c+"px")};b(this._ringNode,a,1);b(this._handleNode,a,this.get("handleDiameter"));b(this._markerNode,a,this.get("markerDiameter"));b(this._centerButtonNode,a,this.get("centerButtonDiameter"));this._ringNodeRadius=this._ringNode.get("offsetWidth")*0.5;this._handleNodeRadius=
this._handleNode.get("offsetWidth")*0.5;this._markerNodeRadius=this._markerNode.get("offsetWidth")*0.5;this._centerButtonNodeRadius=this._centerButtonNode.get("offsetWidth")*0.5;this._handleDistance=this._ringNodeRadius*this.get("handleDistance");a=this._ringNodeRadius-this._centerButtonNodeRadius;this._centerButtonNode.setStyle("left",a+"px");this._centerButtonNode.setStyle("top",a+"px");a=this._centerButtonNodeRadius-this._resetString.get("offsetWidth")*0.5;b=this._centerButtonNodeRadius-this._resetString.get("offsetHeight")*
0.5;this._resetString.setStyles({left:a+"px",top:b+"px"})},_renderLabel:function(){var a=this.get("contentBox"),d=a.one("."+b.CSS_CLASSES.label);if(!d){d=h.create(c.substitute(b.LABEL_TEMPLATE,this.get("strings")));a.append(d)}this._labelNode=d;this._valueStringNode=this._labelNode.one("."+b.CSS_CLASSES.valueString)},_renderRing:function(){var a=this.get("contentBox"),c=a.one("."+b.CSS_CLASSES.ring);if(!c){c=a.appendChild(b.RING_TEMPLATE);c.setStyles({width:this.get("diameter")+"px",height:this.get("diameter")+
"px"})}this._ringNode=c},_renderMarker:function(){var a=this.get("contentBox"),c=a.one("."+b.CSS_CLASSES.marker);c||(c=a.one("."+b.CSS_CLASSES.ring).appendChild(b.MARKER_TEMPLATE));this._markerNode=c},_renderCenterButton:function(){var a=this.get("contentBox"),d=a.one("."+b.CSS_CLASSES.centerButton);if(!d){d=h.create(c.substitute(b.CENTER_BUTTON_TEMPLATE,this.get("strings")));a.one("."+b.CSS_CLASSES.ring).append(d)}this._centerButtonNode=d;this._resetString=this._centerButtonNode.one("."+b.CSS_CLASSES.resetString)},
_renderHandle:function(){var a=b.CSS_CLASSES.label+c.guid(),d=this.get("contentBox"),f=d.one("."+b.CSS_CLASSES.handle);if(!f){f=h.create(c.substitute(b.HANDLE_TEMPLATE,this.get("strings")));f.setAttribute("aria-labelledby",a);this._labelNode.one("."+b.CSS_CLASSES.labelString).setAttribute("id",a);d.one("."+b.CSS_CLASSES.ring).append(f)}this._handleNode=f},_setLabelString:function(a){this.get("contentBox").one("."+b.CSS_CLASSES.labelString).setContent(a)},_setResetString:function(a){this.get("contentBox").one("."+
b.CSS_CLASSES.resetString).setContent(a)},_setTooltipString:function(a){this._handleNode.set("title",a)},_onDirectionKey:function(a){a.preventDefault();switch(a.charCode){case 38:this._incrMinor();break;case 40:this._decrMinor();break;case 36:this._setToMin();break;case 35:this._setToMax();break;case 33:this._incrMajor();break;case 34:this._decrMajor()}},_onLeftRightKey:function(a){a.preventDefault();switch(a.charCode){case 37:this._decrMinor();break;case 39:this._incrMinor()}},_onLeftRightKeyMeta:function(a){a.preventDefault();
switch(a.charCode){case 37:this._setToMin();break;case 39:this._setToMax()}},_incrMinor:function(){var a=this.get("value")+this.get("minorStep"),a=Math.min(a,this.get("max"));this.set("value",a.toFixed(this.get("decimalPlaces"))-0)},_decrMinor:function(){var a=this.get("value")-this.get("minorStep"),a=Math.max(a,this.get("min"));this.set("value",a.toFixed(this.get("decimalPlaces"))-0)},_incrMajor:function(){var a=this.get("value")+this.get("majorStep"),a=Math.min(a,this.get("max"));this.set("value",
a.toFixed(this.get("decimalPlaces"))-0)},_decrMajor:function(){var a=this.get("value")-this.get("majorStep"),a=Math.max(a,this.get("min"));this.set("value",a.toFixed(this.get("decimalPlaces"))-0)},_setToMax:function(){this.set("value",this.get("max"))},_setToMin:function(){this.set("value",this.get("min"))},_resetDial:function(a){a&&a.stopPropagation();this.set("value",this._originalValue);this._resetString.addClass(b.CSS_CLASSES.hidden);this._handleNode.focus()},_getAngleFromValue:function(a){a=
a%this._stepsPerRevolution/this._stepsPerRevolution*360;return a<0?a+360:a},_getValueFromAngle:function(a){a<0?a=360+a:a===0&&(a=360);a=a/360*this._stepsPerRevolution;a=a+this._timesWrapped*this._stepsPerRevolution;return a.toFixed(this.get("decimalPlaces"))-0},_afterValueChange:function(a){this._uiSetValue(a.newVal)},_valueToDecimalPlaces:function(){},_uiSetValue:function(a){this._angle=this._getAngleFromValue(a);if(this._handleNode.hasClass(b.CSS_CLASSES.dragging)===false){this._setTimesWrappedFromValue(a);
this._setNodeToFixedRadius(this._handleNode,false);this._prevAng=this._getAngleFromValue(this.get("value"))}this._valueStringNode.setContent(a.toFixed(this.get("decimalPlaces")));this._handleNode.set("aria-valuenow",a);this._handleNode.set("aria-valuetext",a);this._setNodeToFixedRadius(this._markerNode,false);if(a===this._maxValue||a===this._minValue){this._markerNode.addClass(b.CSS_CLASSES.markerMaxMin);g===true&&this._markerNode.getElementsByTagName("fill").set("color","#AB3232");this._markerNode.removeClass(b.CSS_CLASSES.hidden)}else{g===
true&&this._markerNode.getElementsByTagName("fill").set("color","#000");this._markerNode.removeClass(b.CSS_CLASSES.markerMaxMin);this._handleNode.hasClass(b.CSS_CLASSES.dragging)===false&&this._markerNode.addClass(b.CSS_CLASSES.hidden)}},_validateValue:function(a){var b=this.get("min"),c=this.get("max");return i.isNumber(a)&&a>=b&&a<=c}});c.Dial=b},"3.5.0",{requires:"widget,dd-drag,substitute,event-mouseenter,event-move,event-key,transition,intl".split(","),lang:["en","es"],skinnable:!0});
