YUI.add("dd-delegate",function(a){var f=function(a){f.superclass.constructor.apply(this,arguments)},e=a.Node.create("<div>Temp Node</div>");a.extend(f,a.Base,{_bubbleTargets:a.DD.DDM,dd:null,_shimState:null,_handles:null,_onNodeChange:function(a){this.set("dragNode",a.newVal)},_afterDragEnd:function(){a.DD.DDM._noShim=this._shimState;this.set("lastNode",this.dd.get("node"));this.get("lastNode").removeClass(a.DD.DDM.CSS_PREFIX+"-dragging");this.dd._unprep();this.dd.set("node",e)},_delMouseDown:function(b){var c=
b.currentTarget,d=this.dd;c.test(this.get("nodes"))&&!c.test(this.get("invalid"))&&(this._shimState=a.DD.DDM._noShim,a.DD.DDM._noShim=!0,this.set("currentNode",c),d.set("node",c),d.proxy?d.set("dragNode",a.DD.DDM._proxy):d.set("dragNode",c),d._prep(),d.fire("drag:mouseDown",{ev:b}))},_onMouseEnter:function(){this._shimState=a.DD.DDM._noShim;a.DD.DDM._noShim=!0},_onMouseLeave:function(){a.DD.DDM._noShim=this._shimState},initializer:function(){this._handles=[];var b=this.get("dragConfig")||{},c=this.get("container");
b.node=e.cloneNode(!0);b.bubbleTargets=this;this.get("handles")&&(b.handles=this.get("handles"));this.dd=new a.DD.Drag(b);this.dd.after("drag:end",a.bind(this._afterDragEnd,this));this.dd.on("dragNodeChange",a.bind(this._onNodeChange,this));this.dd.after("drag:mouseup",function(){this._unprep()});this._handles.push(a.delegate(a.DD.Drag.START_EVENT,a.bind(this._delMouseDown,this),c,this.get("nodes")));this._handles.push(a.on("mouseenter",a.bind(this._onMouseEnter,this),c));this._handles.push(a.on("mouseleave",
a.bind(this._onMouseLeave,this),c));a.later(50,this,this.syncTargets);a.DD.DDM.regDelegate(this)},syncTargets:function(){if(a.Plugin.Drop&&!this.get("destroyed")){var b,c,d;if(this.get("target")){b=a.one(this.get("container")).all(this.get("nodes"));c=this.dd.get("groups");if((d=this.get("dragConfig"))&&"groups"in d)c=d.groups;b.each(function(a){this.createDrop(a,c)},this)}return this}},createDrop:function(b,c){var d={useShim:!1,bubbleTargets:this};b.drop||b.plug(a.Plugin.Drop,d);b.drop.set("groups",
c);return b},destructor:function(){this.dd&&this.dd.destroy();a.Plugin.Drop&&a.one(this.get("container")).all(this.get("nodes")).unplug(a.Plugin.Drop);a.each(this._handles,function(a){a.detach()})}},{NAME:"delegate",ATTRS:{container:{value:"body"},nodes:{value:".dd-draggable"},invalid:{value:"input, select, button, a, textarea"},lastNode:{value:e},currentNode:{value:e},dragNode:{value:e},over:{value:!1},target:{value:!1},dragConfig:{value:null},handles:{value:null}}});a.mix(a.DD.DDM,{_delegates:[],
regDelegate:function(a){this._delegates.push(a)},getDelegate:function(b){var c=null,b=a.one(b);a.each(this._delegates,function(a){b.test(a.get("container"))&&(c=a)},this);return c}});a.namespace("DD");a.DD.Delegate=f},"3.5.0",{skinnable:!1,requires:["dd-drag","event-mouseenter","dd-drop-plugin"]});
