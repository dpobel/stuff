YUI.add("matrix",function(k){var f={_rounder:1E5,_round:function(a){return a=Math.round(a*f._rounder)/f._rounder},rad2deg:function(a){return a*(180/Math.PI)},deg2rad:function(a){return a*(Math.PI/180)},angle2rad:function(a){return a="string"===typeof a&&-1<a.indexOf("rad")?parseFloat(a):f.deg2rad(parseFloat(a))},convertTransformToArray:function(a){return[[a.a,a.c,a.dx],[a.b,a.d,a.dy],[0,0,1]]},getDeterminant:function(a){var d=0,b=a.length,c=0,e;if(2==b)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;c<
b;++c)e=a[c][0],d=0===c%2||0===c?d+e*f.getDeterminant(f.getMinors(a,c,0)):d-e*f.getDeterminant(f.getMinors(a,c,0));return d},inverse:function(a){var d=0,b=a.length,c=0,e,i=[],g=[];if(2===b)d=a[0][0]*a[1][1]-a[0][1]*a[1][0],a=[[a[1][1]*d,-a[1][0]*d],[-a[0][1]*d,a[0][0]*d]];else{for(d=f.getDeterminant(a);c<b;++c){i[c]=[];for(e=0;e<b;++e)g=f.getMinors(a,e,c),i[c][e]=f.getDeterminant(g),0!==(c+e)%2&&0!==c+e&&(i[c][e]*=-1)}a=f.scalarMultiply(i,1/d)}return a},scalarMultiply:function(a,d){for(var b=0,c,
e=a.length;b<e;++b)for(c=0;c<e;++c)a[b][c]=f._round(a[b][c]*d);return a},transpose:function(a){for(var d=a.length,b=0,c=0,e=[];b<d;++b){e[b]=[];for(c=0;c<d;++c)e[b].push(a[c][b])}return e},getMinors:function(a,d,b){for(var c=[],e=a.length,i=0,g,f;i<e;++i)if(i!==d){f=[];for(g=0;g<e;++g)g!==b&&f.push(a[i][g]);c.push(f)}return c},sign:function(a){return 0===a?1:a/Math.abs(a)},vectorMatrixProduct:function(a,d){var b,c,e=a.length,f=[],g;for(b=0;b<e;++b){for(c=g=0;c<e;++c)g+=a[b]*d[b][c];f[b]=g}return f},
decompose:function(a){var d=a[0][0],b=a[1][0],c=a[0][1],e=a[1][1],i=a[0][2],g=a[1][2],j,l,h;if(0===d*e-b*c)return!1;j=f._round(Math.sqrt(d*d+b*b));d/=j;b/=j;h=f._round(d*c+b*e);c-=d*h;e-=b*h;l=f._round(Math.sqrt(c*c+e*e));h/=l;d*b<c/l*(e/l)&&(h=-h,j=-j,l=-l);h=f._round(f.rad2deg(Math.atan(h)));a=f._round(f.rad2deg(Math.atan2(a[1][0],a[0][0])));return[["translate",i,g],["rotate",a],["skewX",h],["scale",j,l]]},getTransformArray:function(a){for(var d=/\s*([a-z]*)\(([\w,\.,\-,\s]*)\)/gi,b=[],c,e,i=f.transformMethods;e=
d.exec(a);)i.hasOwnProperty(e[1])?(c=e[2].split(","),c.unshift(e[1]),b.push(c)):"matrix"==e[1]&&(c=e[2].split(","),c=f.decompose([[c[0],c[2],c[4]],[c[1],c[3],c[5]],[0,0,1]]),b.push(c[0]),b.push(c[1]),b.push(c[2]),b.push(c[3]));return b},getTransformFunctionArray:function(a){switch(a){case "skew":a=[a,0,0];break;case "scale":a=[a,1,1];break;case "scaleX":a=[a,1];break;case "scaleY":a=[a,1];break;case "translate":a=[a,0,0];break;default:a=[a,0]}return a},compareTransformSequence:function(a,d){var b=
0,c=a.length,e=c===d.length;if(e)for(;b<c;++b)if(a[b][0]!=d[b][0]){e=!1;break}return e},transformMethods:{rotate:"rotate",skew:"skew",skewX:"skewX",skewY:"skewY",translate:"translate",translateX:"translateX",translateY:"tranlsateY",scale:"scale",scaleX:"scaleX",scaleY:"scaleY"}};k.MatrixUtil=f;var m=function(a){this.init(a)};m.prototype={_rounder:1E5,multiply:function(a,d,b,c,e,f){var g=this.b*a+this.d*d,j=this.a*b+this.c*c,b=this.b*b+this.d*c,c=this.a*e+this.c*f+this.dx,e=this.b*e+this.d*f+this.dy;
this.a=this.a*a+this.c*d;this.b=g;this.c=j;this.d=b;this.dx=c;this.dy=e;return this},applyCSSText:function(a){for(var d=/\s*([a-z]*)\(([\w,\s]*)\)/gi,b,c;c=d.exec(a);)"function"===typeof this[c[1]]&&(b=c[2].split(","),this[c[1]].apply(this,b))},getTransformArray:function(a){for(var d=/\s*([a-z]*)\(([\w,\.,\-,\s]*)\)/gi,b=[],c,e,a=a.replace(/matrix/g,"multiply");e=d.exec(a);)"function"===typeof this[e[1]]&&(c=e[2].split(","),c.unshift(e[1]),b.push(c));return b},_defaults:{a:1,b:0,c:0,d:1,dx:0,dy:0},
_round:function(a){return a=Math.round(a*this._rounder)/this._rounder},init:function(a){var d=this._defaults,b,a=a||{};for(b in d)d.hasOwnProperty(b)&&(this[b]=b in a?a[b]:d[b]);this._config=a},scale:function(a,d){this.multiply(a,0,0,d,0,0);return this},skew:function(a,d){a=a||0;d=d||0;void 0!==a&&(a=this._round(Math.tan(this.angle2rad(a))));void 0!==d&&(d=this._round(Math.tan(this.angle2rad(d))));this.multiply(1,d,a,1,0,0);return this},skewX:function(a){this.skew(a);return this},skewY:function(a){this.skew(null,
a);return this},toCSSText:function(){var a=this.dx,d=this.dy,b="matrix(";k.UA.gecko&&(isNaN(a)||(a+="px"),isNaN(d)||(d+="px"));b+=this.a+","+this.b+","+this.c+","+this.d+","+a+","+d;return b+")"},toFilterText:function(){var a;a="progid:DXImageTransform.Microsoft.Matrix("+("M11="+this.a+",M21="+this.b+",M12="+this.c+",M22="+this.d+',sizingMethod="auto expand")');return a+""},rad2deg:function(a){return a*(180/Math.PI)},deg2rad:function(a){return a*(Math.PI/180)},angle2rad:function(a){return a="string"===
typeof a&&-1<a.indexOf("rad")?parseFloat(a):this.deg2rad(parseFloat(a))},rotate:function(a){var d=this.angle2rad(a),a=this._round(Math.sin(d)),d=this._round(Math.cos(d));this.multiply(d,a,0-a,d,0,0);return this},translate:function(a,d){a=parseFloat(a)||0;d=parseFloat(d)||0;this.multiply(1,0,0,1,a,d);return this},identity:function(){var a=this._config,d=this._defaults,b;for(b in a)b in d&&(this[b]=d[b]);return this},getMatrixArray:function(){return[[this.a,this.c,this.dx],[this.b,this.d,this.dy],[0,
0,1]]},getContentRect:function(a,d,b,c){var b=!isNaN(b)?b:0,e=!isNaN(c)?c:0,a=b+a,f=e+d,g=this.a,j=this.b,l=this.c,h=this.d,k=this.dx,n=this.dy,d=g*b+l*e+k,c=j*b+h*e+n,m=g*a+l*e+k,e=j*a+h*e+n,o=g*b+l*f+k,b=j*b+h*f+n,g=g*a+l*f+k,a=j*a+h*f+n;return{left:Math.min(o,Math.min(d,Math.min(m,g))),right:Math.max(o,Math.max(d,Math.max(m,g))),top:Math.min(e,Math.min(a,Math.min(b,c))),bottom:Math.max(e,Math.max(a,Math.max(b,c)))}},getDeterminant:function(){return k.MatrixUtil.getDeterminant(this.getMatrixArray())},
inverse:function(){return k.MatrixUtil.inverse(this.getMatrixArray())},transpose:function(){return k.MatrixUtil.transpose(this.getMatrixArray())},decompose:function(){return k.MatrixUtil.decompose(this.getMatrixArray())}};k.Matrix=m},"3.5.0",{requires:["yui-base"]});
