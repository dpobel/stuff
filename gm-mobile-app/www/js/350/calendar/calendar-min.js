YUI.add("calendar",function(g){function m(a){m.superclass.constructor.apply(this,arguments)}var f=g.ClassNameManager.getClassName;f("calendar","header");var j=f("calendar","day-selected"),k=f("calendar","day-highlighted"),h=f("calendar","day"),n=f("calendar","prevmonth-day"),o=f("calendar","nextmonth-day"),l=f("calendar","grid"),c=g.DataType.Date,p=f("calendar","pane"),i=g.UA.os;g.Calendar=g.extend(m,g.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(g.Plugin.CalendarNavigator);
this._keyEvents=[];this._lastSelectedDate=this._highlightedDateNode=null},syncUI:function(){},_bindCalendarEvents:function(){var a=this.get("contentBox").one("."+p);a.on("selectstart",function(a){a.preventDefault()});a.delegate("click",this._clickCalendar,"."+h,this);a.delegate("keydown",this._keydownCalendar,"."+l,this);a.delegate("focus",this._focusCalendarGrid,"."+l,this);a.delegate("focus",this._focusCalendarCell,"."+h,this);a.delegate("blur",this._blurCalendarGrid,"."+l+",."+h,this)},_highlightDateNode:function(a){this._unhighlightCurrentDateNode();
a=this._dateToNode(a);a.focus();a.addClass(k)},_unhighlightCurrentDateNode:function(){var a=this.get("contentBox").all("."+k);a&&a.removeClass(k)},_getGridNumber:function(a){a=a.get("id").split("_").reverse();return parseInt(a[0],10)},_blurCalendarGrid:function(){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(a){this._highlightedDateNode=a.target;a.stopPropagation()},_focusCalendarGrid:function(){this._unhighlightCurrentDateNode();this._highlightedDateNode=null},_keydownCalendar:function(a){var b=
this._getGridNumber(a.target),d=!this._highlightedDateNode?null:this._nodeToDate(this._highlightedDateNode),e=a.keyCode,f=0;switch(e){case 40:f=7;break;case 38:f=-7;break;case 37:f=-1;break;case 39:f=1;break;case 32:case 13:if(a.preventDefault(),this._highlightedDateNode){var g=this.get("selectionMode");if("single"===g&&!this._highlightedDateNode.hasClass(j))this._clearSelection(!0),this._addDateToSelection(d);else if("multiple"===g||"multiple-sticky"===g)this._highlightedDateNode.hasClass(j)?this._removeDateFromSelection(d):
this._addDateToSelection(d)}}if(40==e||38==e||37==e||39==e)(d||(d=c.addMonths(this.get("date"),b),f=0),a.preventDefault(),a=c.addDays(d,f),b=this.get("date"),d=c.addMonths(this.get("date"),this._paneNumber-1),e=new Date(d),d.setDate(c.daysInMonth(d)),c.isInRange(a,b,d))?this._highlightDateNode(a):c.isGreater(b,a)?c.isGreaterOrEqual(this.get("minimumDate"),b)||(this.set("date",c.addMonths(b,-1)),this._highlightDateNode(a)):c.isGreater(a,d)&&!c.isGreaterOrEqual(e,this.get("maximumDate"))&&(this.set("date",
c.addMonths(b,1)),this._highlightDateNode(a))},_clickCalendar:function(a){var b=a.target,c=b.hasClass(h)&&!b.hasClass(n)&&!b.hasClass(o),e=b.hasClass(j);switch(this.get("selectionMode")){case "single":c&&!e&&(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(b)));break;case "multiple-sticky":c&&(e?this._removeDateFromSelection(this._nodeToDate(b)):this._addDateToSelection(this._nodeToDate(b)));break;case "multiple":!a.metaKey&&!a.ctrlKey&&!a.shiftKey?(this._clearSelection(!0),this._lastSelectedDate=
this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):("macintosh"==i&&a.metaKey||"macintosh"!=i&&a.ctrlKey)&&!a.shiftKey?e?(this._removeDateFromSelection(this._nodeToDate(b)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):("macintosh"==i&&a.metaKey||"macintosh"!=i&&a.ctrlKey)&&a.shiftKey?this._lastSelectedDate?(a=this._nodeToDate(b),this._addDateRangeToSelection(a,this._lastSelectedDate),this._lastSelectedDate=
a):(this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)):a.shiftKey&&(this._lastSelectedDate?(a=this._nodeToDate(b),this._clearSelection(!0),this._addDateRangeToSelection(a,this._lastSelectedDate),this._lastSelectedDate=a):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(b),this._addDateToSelection(this._lastSelectedDate)))}c?this.fire("dateClick",{cell:b,date:this._nodeToDate(b)}):b.hasClass(n)?this.fire("prevMonthClick"):b.hasClass(o)&&this.fire("nextMonthClick")},
subtractMonth:function(a){this.set("date",c.addMonths(this.get("date"),-1));a.halt()},subtractYear:function(a){this.set("date",c.addYears(this.get("date"),-1));a.halt()},addMonth:function(a){this.set("date",c.addMonths(this.get("date"),1));a.halt()},addYear:function(a){this.set("date",c.addYears(this.get("date"),1));a.halt()}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(a){var a=this._normalizeDate(a),b=c.addMonths(a,this._paneNumber-1),d=
this.get("minimumDate"),e=this.get("maximumDate");if((!d||c.isGreaterOrEqual(a,d))&&(!e||c.isGreaterOrEqual(e,b)))return a;if(d&&c.isGreater(d,a))return d;if(e&&c.isGreater(b,e))return c.addMonths(e,-1*(this._paneNumber-1))}},minimumDate:{value:null,setter:function(a){if(a){var b=this.get("date"),a=this._normalizeDate(a);b&&!c.isGreaterOrEqual(b,a)&&this.set("date",a);return a}return this._normalizeDate(a)}},maximumDate:{value:null,setter:function(a){if(a){var b=this.get("date"),d=this._normalizeDate(a);
b&&!c.isGreaterOrEqual(a,c.addMonths(b,this._paneNumber-1))&&this.set("date",c.addMonths(d,-1*(this._paneNumber-1)));return d}return a}}}})},"3.5.0",{requires:["calendar-base","calendarnavigator"],lang:"de,en,fr,ja,nb-NO,pt-BR,ru,zh-HANT-TW".split(",")});
