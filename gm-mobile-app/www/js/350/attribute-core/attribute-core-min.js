YUI.add("attribute-core",function(f){function i(a,b,c){this._initAttrHost(a,b,c)}f.State=function(){this.data={}};f.State.prototype={add:function(a,b,c){var d=this.data;d[a]=d[a]||{};d[a][b]=c},addAll:function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.add(a,c,b[c])},remove:function(a,b){var c=this.data;c[a]&&delete c[a][b]},removeAll:function(a,b){var c=this.data;b?f.each(b,function(b,c){f.Lang.isString(c)?this.remove(a,c):this.remove(a,b)},this):c[a]&&delete c[a]},get:function(a,b){var c=this.data;
return c[a]?c[a][b]:void 0},getAll:function(a,b){var c=this.data,d;b?d=c[a]:f.each(c[a],function(a,b){d=d||{};d[b]=a});return d}};var k=f.Object,p=f.Lang,o;i.INVALID_VALUE={};o=i.INVALID_VALUE;i._ATTR_CFG="setter,getter,validator,value,valueFn,writeOnce,readOnly,lazyAdd,_bypassProxy".split(",");i.prototype={_initAttrHost:function(a,b,c){this._state=new f.State;this._initAttrs(a,b,c)},addAttr:function(a,b,c){var d=this._state,e,b=b||{};if((c="lazyAdd"in b?b.lazyAdd:c)&&!this.attrAdded(a))d.addAll(a,
{lazy:b,added:!0});else if(!this.attrAdded(a)||d.get(a,"isLazyAdd")){if(c="value"in b)e=b.value,delete b.value;b.added=!0;b.initializing=!0;d.addAll(a,b);c&&this.set(a,e);d.remove(a,"initializing")}return this},attrAdded:function(a){return!!this._state.get(a,"added")},get:function(a){return this._getAttr(a)},_isLazyAttr:function(a){return this._state.get(a,"lazy")},_addLazyAttr:function(a){var b=this._state,c=b.get(a,"lazy");b.add(a,"isLazyAdd",!0);b.remove(a,"lazy");this.addAttr(a,c)},set:function(a,
b){return this._setAttr(a,b)},_set:function(a,b){return this._setAttr(a,b,null,!0)},_setAttr:function(a,b,c,d){var e=!0,g=this._state,l=this._stateProxy,m,i,j,h,n;-1!==a.indexOf(".")&&(i=a,j=a.split("."),a=j.shift());this._isLazyAttr(a)&&this._addLazyAttr(a);g=g.getAll(a,!0)||{};m=!("value"in g);l&&a in l&&!g._bypassProxy&&(m=!1);l=g.writeOnce;n=g.initializing;!m&&!d&&(l&&(e=!1),g.readOnly&&(e=!1));!n&&!d&&"initOnly"===l&&(e=!1);e&&(m||(h=this.get(a)),j&&(b=k.setValue(f.clone(h),j,b),void 0===b&&
(e=!1)),e&&(!this._fireAttrChange||n?this._setAttrVal(a,i,h,b):this._fireAttrChange(a,i,h,b,c)));return this},_getAttr:function(a){var b=a,c=this._state,d,e;-1!==a.indexOf(".")&&(d=a.split("."),a=d.shift());this._tCfgs&&this._tCfgs[a]&&(e={},e[a]=this._tCfgs[a],delete this._tCfgs[a],this._addAttrs(e,this._tVals));this._isLazyAttr(a)&&this._addLazyAttr(a);e=this._getStateVal(a);(a=c.get(a,"getter"))&&!a.call&&(a=this[a]);e=a?a.call(this,e,b):e;return e=d?k.getValue(e,d):e},_getStateVal:function(a){var b=
this._stateProxy;return b&&a in b&&!this._state.get(a,"_bypassProxy")?b[a]:this._state.get(a,"value")},_setStateVal:function(a,b){var c=this._stateProxy;c&&a in c&&!this._state.get(a,"_bypassProxy")?c[a]=b:this._state.add(a,"value",b)},_setAttrVal:function(a,b,c,d){var c=!0,e=this._state.getAll(a,!0)||{},g=e.validator,f=e.setter,i=e.initializing,k=this._getStateVal(a),j=b||a,h;g&&(g.call||(g=this[g]),g&&(h=g.call(this,d,j),!h&&i&&(d=e.defaultValue,h=!0)));if(!g||h){if(f&&(f.call||(f=this[f]),f&&(h=
f.call(this,d,j),h===o?c=!1:void 0!==h&&(d=h))),c)!b&&d===k&&!p.isObject(d)?c=!1:("initValue"in e||(e.initValue=d),this._setStateVal(a,d))}else c=!1;return c},setAttrs:function(a){return this._setAttrs(a)},_setAttrs:function(a){for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b]);return this},getAttrs:function(a){return this._getAttrs(a)},_getAttrs:function(a){var b={},c,d,e,f=!0===a,a=a&&!f?a:k.keys(this._state.data);c=0;for(d=a.length;c<d;c++)if(e=a[c],this.get(e),!f||this._getStateVal(e)!=this._state.get(e,
"initValue"))b[e]=this.get(e);return b},addAttrs:function(a,b,c){a&&(this._tCfgs=a,this._tVals=this._normAttrVals(b),this._addAttrs(a,this._tVals,c),this._tCfgs=this._tVals=null);return this},_addAttrs:function(a,b,c){var d,e;for(d in a)a.hasOwnProperty(d)&&(b=a[d],b.defaultValue=b.value,e=this._getAttrInitVal(d,b,this._tVals),void 0!==e&&(b.value=e),this._tCfgs[d]&&delete this._tCfgs[d],this.addAttr(d,b,c))},_protectAttrs:function(a){if(a){var a=f.merge(a),b;for(b in a)a.hasOwnProperty(b)&&(a[b]=
f.merge(a[b]))}return a},_normAttrVals:function(a){return a?f.merge(a):null},_getAttrInitVal:function(a,b,c){if(!b.readOnly&&c&&c.hasOwnProperty(a))c=c[a];else if(c=b.value,b=b.valueFn)b.call||(b=this[b]),b&&(c=b.call(this,a));return c},_initAttrs:function(a,b,c){var a=a||this.constructor.ATTRS,d=f.Base,e=f.BaseCore,d=d&&f.instanceOf(this,d),e=!d&&e&&f.instanceOf(this,e);a&&!d&&!e&&this.addAttrs(this._protectAttrs(a),b,c)}};f.AttributeCore=i},"3.5.0");
