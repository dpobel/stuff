YUI.add("event-synthetic",function(e){function o(a,b){this.handle=a;this.emitFacade=b}function l(a,b,c){this.handles=[];this.el=a;this.key=c;this.domkey=b}function k(){this._init.apply(this,arguments)}var m=e.Env.evt.dom_map,j=e.Array,h=e.Lang,p=h.isObject,n=h.isString,r=h.isArray,q=e.Selector.query,h=function(){};o.prototype.fire=function(a){var b=j(arguments,0,!0),c=this.handle,d=c.evt,c=c.sub,f=c.context,g=c.filter,i=a||{};if(this.emitFacade){if(!a||!a.preventDefault)i=d._getFacade(),p(a)&&!a.preventDefault?
(e.mix(i,a,!0),b[0]=i):b.unshift(i);i.type=d.type;i.details=b.slice();g&&(i.container=d.host)}else g&&p(a)&&a.currentTarget&&b.shift();c.context=f||i.currentTarget||d.host;b=d.fire.apply(d,b);c.context=f;return b};l.prototype={constructor:l,type:"_synth",fn:h,capture:!1,register:function(a){a.evt.registry=this;this.handles.push(a)},unregister:function(a){var b=this.handles,c=m[this.domkey],d;for(d=b.length-1;0<=d;--d)if(b[d].sub===a){b.splice(d,1);break}b.length||(delete c[this.key],e.Object.size(c)||
delete m[this.domkey])},detachAll:function(){for(var a=this.handles,b=a.length;0<=--b;)a[b].detach()}};e.mix(k,{Notifier:o,SynthRegistry:l,getRegistry:function(a,b,c){var a=a._node,d=e.stamp(a),b="event:"+d+b+"_synth",f=m[d];c&&(f||(f=m[d]={}),f[b]||(f[b]=new l(a,d,b)));return f&&f[b]||null},_deleteSub:function(a){if(a&&a.fn){var b=this.eventDef,c=a.filter?"detachDelegate":"detach";this.subscribers={};this.subCount=0;b[c](a.node,a,this.notifier,a.filter);this.registry.unregister(a);delete a.fn;delete a.node;
delete a.context}},prototype:{constructor:k,_init:function(){var a=this.publishConfig||(this.publishConfig={});this.emitFacade="emitFacade"in a?a.emitFacade:!0;a.emitFacade=!1},processArgs:h,on:h,detach:h,delegate:h,detachDelegate:h,_on:function(a,b){var c=[],d=a.slice(),f=this.processArgs(a,b),g=a[2],i=b?"delegate":"on",h,k;h=n(g)?q(g):j(g||e.one(e.config.win));if(!h.length&&n(g))return k=e.on("available",function(){e.mix(k,e[i].apply(e,d),!0)},g);e.Array.each(h,function(d){var g=a.slice(),h;if(d=
e.one(d))b&&(h=g.splice(3,1)[0]),g.splice(0,4,g[1],g[3]),(!this.preventDups||!this.getSubs(d,a,null,!0))&&c.push(this._subscribe(d,i,g,f,h))},this);return 1===c.length?c[0]:new e.EventHandle(c)},_subscribe:function(a,b,c,d,f){var g=new e.CustomEvent(this.type,this.publishConfig),c=g.on.apply(g,c),i=new o(c,this.emitFacade),h=k.getRegistry(a,this.type,!0),j=c.sub;j.node=a;j.filter=f;d&&this.applyArgExtras(d,j);e.mix(g,{eventDef:this,notifier:i,host:a,currentTarget:a,target:a,el:a._node,_delete:k._deleteSub},
!0);c.notifier=i;h.register(c);this[b](a,j,i,f);return c},applyArgExtras:function(a,b){b._extra=a},_detach:function(a){var b=a[2],b=n(b)?q(b):j(b),c,d,f,g;a.splice(2,1);d=0;for(f=b.length;d<f;++d)if(c=e.one(b[d]))if(c=this.getSubs(c,a))for(g=c.length-1;0<=g;--g)c[g].detach()},getSubs:function(a,b,c,d){var f=k.getRegistry(a,this.type),a=[],g,e,h;if(f){f=f.handles;c||(c=this.subMatch);g=0;for(e=f.length;g<e;++g)if(h=f[g],c.call(this,h.sub,b)){if(d)return h;a.push(f[g])}}return a.length&&a},subMatch:function(a,
b){return!b[1]||a.fn===b[1]}}},!0);e.SyntheticEvent=k;e.Event.define=function(a,b,c){var d,f;a&&a.type?(d=a,c=b):b&&(d=e.merge({type:a},b));if(d){if(c||!e.Node.DOM_EVENTS[d.type])a=function(){k.apply(this,arguments)},e.extend(a,k,d),f=new a,a=f.type,e.Node.DOM_EVENTS[a]=e.Env.evt.plugins[a]={eventDef:f,on:function(){return f._on(j(arguments))},delegate:function(){return f._on(j(arguments),true)},detach:function(){return f._detach(j(arguments))}}}else(n(a)||r(a))&&e.Array.each(j(a),function(a){e.Node.DOM_EVENTS[a]=
1});return f}},"3.5.1",{requires:["node-base","event-custom-complex"]});
