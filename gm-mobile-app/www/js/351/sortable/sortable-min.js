YUI.add("sortable",function(c){var e=function(a){e.superclass.constructor.apply(this,arguments)};c.extend(e,c.Base,{delegate:null,initializer:function(){var a="sortable-"+c.guid(),b={container:this.get("container"),nodes:this.get("nodes"),target:!0,invalid:this.get("invalid"),dragConfig:{groups:[a]}};this.get("handles")&&(b.handles=this.get("handles"));b=new c.DD.Delegate(b);this.set("id",a);b.dd.plug(c.Plugin.DDProxy,{moveOnEnd:!1,cloneNode:!0});(new c.DD.Drop({node:this.get("container"),bubbleTarget:b,
groups:b.dd.get("groups")})).on("drop:over",c.bind(this._onDropOver,this));b.on({"drag:start":c.bind(this._onDragStart,this),"drag:end":c.bind(this._onDragEnd,this),"drag:over":c.bind(this._onDragOver,this),"drag:drag":c.bind(this._onDrag,this)});this.delegate=b;e.reg(this)},_up:null,_y:null,_onDrag:function(a){a.pageY<this._y?this._up=!0:a.pageY>this._y&&(this._up=!1);this._y=a.pageY},_onDropOver:function(a){a.drop.get("node").test(this.get("nodes"))||0===a.drop.get("node").all(this.get("nodes")).size()&&
a.drop.get("node").append(a.drag.get("node"))},_onDragOver:function(a){if(a.drop.get("node").test(this.get("nodes"))&&a.drag.get("node")!=a.drop.get("node")&&!a.drag.get("node").contains(a.drop.get("node"))){var b=!1,d,f,e,g=this.get("moveType").toLowerCase();a.drag.get("node").get("parentNode").contains(a.drop.get("node"))&&(b=!0);b&&"move"==g&&(g="insert");switch(g){case "insert":d=this._up?"before":"after";f=a.drop.get("node");c.Sortable._test(f,this.get("container"))?f.append(a.drag.get("node")):
f.insert(a.drag.get("node"),d);break;case "swap":c.DD.DDM.swapNode(a.drag,a.drop);break;case "move":case "copy":e=c.Sortable.getSortable(a.drop.get("node").get("parentNode"));if(!e)return;c.DD.DDM.getDrop(a.drag.get("node")).addToGroup(e.get("id"));b?c.DD.DDM.swapNode(a.drag,a.drop):("copy"==this.get("moveType")&&(d=a.drag.get("node"),f=d.cloneNode(!0),f.set("id",""),a.drag.set("node",f),e.delegate.createDrop(f,[e.get("id")]),d.setStyles({top:"",left:""})),a.drop.get("node").insert(a.drag.get("node"),
"before"))}this.fire(g,{same:b,drag:a.drag,drop:a.drop});this.fire("moved",{same:b,drag:a.drag,drop:a.drop})}},_onDragStart:function(){this.delegate.get("lastNode").setStyle("zIndex","");this.delegate.get(this.get("opacityNode")).setStyle("opacity",this.get("opacity"));this.delegate.get("currentNode").setStyle("zIndex","999")},_onDragEnd:function(){this.delegate.get(this.get("opacityNode")).setStyle("opacity",1);this.delegate.get("currentNode").setStyles({top:"",left:""});this.sync()},plug:function(a,
b){a&&"sort"===a.NAME.substring(0,4).toLowerCase()?this.constructor.superclass.plug.call(this,a,b):this.delegate.dd.plug(a,b);return this},sync:function(){this.delegate.syncTargets();return this},destructor:function(){this.delegate.destroy();e.unreg(this)},join:function(a,b){if(!(a instanceof c.Sortable))return c.error("Sortable: join needs a Sortable Instance"),this;b||(b="full");var b=b.toLowerCase(),d="_join_"+b;if(this[d])this[d](a);return this},_join_none:function(a){this.delegate.dd.removeFromGroup(a.get("id"));
a.delegate.dd.removeFromGroup(this.get("id"))},_join_full:function(a){this.delegate.dd.addToGroup(a.get("id"));a.delegate.dd.addToGroup(this.get("id"))},_join_outer:function(a){this.delegate.dd.addToGroup(a.get("id"))},_join_inner:function(a){a.delegate.dd.addToGroup(this.get("id"))},getOrdering:function(a){var b=[];c.Lang.isFunction(a)||(a=function(a){return a});c.one(this.get("container")).all(this.get("nodes")).each(function(c){b.push(a(c))});return b}},{NAME:"sortable",ATTRS:{handles:{value:!1},
container:{value:"body"},nodes:{value:".dd-draggable"},opacity:{value:".75"},opacityNode:{value:"currentNode"},id:{value:null},moveType:{value:"insert"},invalid:{value:""}},_sortables:[],_test:function(a,b){return b instanceof c.Node?b===a:a.test(b)},getSortable:function(a){var b=null,a=c.one(a);c.each(c.Sortable._sortables,function(d){c.Sortable._test(a,d.get("container"))&&(b=d)});return b},reg:function(a){c.Sortable._sortables.push(a)},unreg:function(a){c.each(c.Sortable._sortables,function(b,
d){b===a&&(c.Sortable._sortables[d]=null,delete e._sortables[d])})}});c.Sortable=e},"3.5.1",{requires:["dd-delegate","dd-drop-plugin","dd-proxy"]});
