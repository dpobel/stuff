YUI.add("widget-parent",function(c){function h(a){this.publish("addChild",{defaultTargetOnly:!0,defaultFn:this._defAddChildFn});this.publish("removeChild",{defaultTargetOnly:!0,defaultFn:this._defRemoveChildFn});this._items=[];var b,d;a&&a.children&&(b=a.children,d=this.after("initializedChange",function(){this._add(b);d.detach()}));c.after(this._renderChildren,this,"renderUI");c.after(this._bindUIParent,this,"bindUI");this.after("selectionChange",this._afterSelectionChange);this.after("selectedChange",
this._afterParentSelectedChange);this.after("activeDescendantChange",this._afterActiveDescendantChange);this._hDestroyChild=this.after("*:destroy",this._afterDestroyChild);this.after("*:focusedChange",this._updateActiveDescendant)}var f=c.Lang;h.ATTRS={defaultChildType:{setter:function(a){var b=c.Attribute.INVALID_VALUE,a=f.isString(a)?c[a]:a;f.isFunction(a)&&(b=a);return b}},activeDescendant:{readOnly:!0},multiple:{value:!1,validator:f.isBoolean,writeOnce:!0,getter:function(a){var b=this.get("root");
return b&&b!=this?b.get("multiple"):a}},selection:{readOnly:!0,setter:"_setSelection",getter:function(a){return f.isArray(a)?new c.ArrayList(a):a}},selected:{setter:function(a){var b=a;1===a&&!this.get("multiple")&&(b=c.Attribute.INVALID_VALUE);return b}}};h.prototype={destructor:function(){this._destroyChildren()},_afterDestroyChild:function(a){a=a.target;a.get("parent")==this&&a.remove()},_afterSelectionChange:function(a){if(a.target==this&&a.src!=this){var a=a.newVal,b=0;a&&(b=2,c.instanceOf(a,
c.ArrayList)&&a.size()===this.size()&&(b=1));this.set("selected",b,{src:this})}},_afterActiveDescendantChange:function(a){var b=this.get("parent");b&&b._set("activeDescendant",a.newVal)},_afterParentSelectedChange:function(a){var b=a.newVal;this==a.target&&a.src!=this&&(0===b||1===b)&&this.each(function(a){a.set("selected",b,{src:this})},this)},_setSelection:function(a){var b=null,d;this.get("multiple")&&!this.isEmpty()?(d=[],this.each(function(a){0<a.get("selected")&&d.push(a)}),0<d.length&&(b=d)):
0<a.get("selected")&&(b=a);return b},_updateSelection:function(a){var b=a.target,d;b.get("parent")==this&&("_updateSelection"!=a.src&&(d=this.get("selection"),!this.get("multiple")&&d&&0<a.newVal&&d.set("selected",0,{src:"_updateSelection"}),this._set("selection",b)),a.src==this&&this._set("selection",b,{src:this}))},_updateActiveDescendant:function(a){this._set("activeDescendant",!0===a.newVal?a.target:null)},_createChild:function(a){var b=this.get("defaultChildType"),d=a.childType||a.type,e,g,i;
d&&(g=f.isString(d)?c[d]:d);f.isFunction(g)?i=g:b&&(i=b);i?e=new i(a):c.error("Could not create a child instance because its constructor is either undefined or invalid.");return e},_defAddChildFn:function(a){var b=a.child,d=a.index,e=this._items;b.get("parent")&&b.remove();f.isNumber(d)?e.splice(d,0,b):e.push(b);b._set("parent",this);b.addTarget(this);a.index=b.get("index");b.after("selectedChange",c.bind(this._updateSelection,this))},_defRemoveChildFn:function(a){var b=a.child,a=a.index,d=this._items;
b.get("focused")&&b.blur();b.get("selected")&&b.set("selected",0);d.splice(a,1);b.removeTarget(this);b._oldParent=b.get("parent");b._set("parent",null)},_add:function(a,b){var d,e,g;f.isArray(a)?(d=[],c.each(a,function(a,c){(e=this._add(a,b+c))&&d.push(e)},this),0<d.length&&(g=d)):(e=c.instanceOf(a,c.Widget)?a:this._createChild(a))&&this.fire("addChild",{child:e,index:b})&&(g=e);return g},add:function(){var a=this._add.apply(this,arguments),a=a?f.isArray(a)?a:[a]:[];return new c.ArrayList(a)},remove:function(a){var b=
this._items[a],d;b&&this.fire("removeChild",{child:b,index:a})&&(d=b);return d},removeAll:function(){var a=[],b;c.each(this._items.concat(),function(){(b=this.remove(0))&&a.push(b)},this);return new c.ArrayList(a)},selectChild:function(a){this.item(a).set("selected",1)},selectAll:function(){this.set("selected",1)},deselectAll:function(){this.set("selected",0)},_uiAddChild:function(a,b){a.render(b);var d=a.get("boundingBox"),c;(c=a.next(!1))&&c.get("rendered")?(c=c.get("boundingBox"),c.insert(d,"before")):
(c=a.previous(!1))&&c.get("rendered")?(c=c.get("boundingBox"),c.insert(d,"after")):b.contains(d)||b.appendChild(d)},_uiRemoveChild:function(a){a.get("boundingBox").remove()},_afterAddChild:function(a){a=a.child;a.get("parent")==this&&this._uiAddChild(a,this._childrenContainer)},_afterRemoveChild:function(a){a=a.child;a._oldParent==this&&this._uiRemoveChild(a)},_bindUIParent:function(){this.after("addChild",this._afterAddChild);this.after("removeChild",this._afterRemoveChild)},_renderChildren:function(){var a=
this._childrenContainer||this.get("contentBox");this._childrenContainer=a;this.each(function(b){b.render(a)})},_destroyChildren:function(){this._hDestroyChild.detach();this.each(function(a){a.destroy()})}};c.augment(h,c.ArrayList);c.WidgetParent=h},"3.5.1",{requires:["base-build","arraylist","widget"]});
