YUI.add("pjax-base",function(d){function g(){}var f=d.config.win,h=d.ClassNameManager.getClassName("pjax");g.prototype={_regexURL:/^((?:[^\/#?:]+:\/\/|\/\/)[^\/]*)?([^?#]*)(\?[^#]*)?(#.*)?$/,initializer:function(){this.publish("navigate",{defaultFn:this._defNavigateFn});this.get("html5")&&this._pjaxBindUI()},destructor:function(){this._pjaxEvents&&this._pjaxEvents.detach()},navigate:function(a,b){a=this._resolveURL(a);if(this._navigate(a,b))return!0;this._hasSameOrigin(a)||d.error("Security error: The new URL must be of the same origin as the current URL.");
return!1},_getRoot:function(){var a=d.getLocation().pathname;if("/"===a.charAt(a.length-1))return a;a=a.split("/");a.pop();return a.join("/")+"/"},_navigate:function(a,b){if(!this.hasRoute(a))return!1;b||(b={});b.url=a;var c=this._getURL(),e,d;d=a.replace(/(#.*)$/,function(a,b,c){e=b;return a.substring(c)});if(e&&d===c.replace(/#.*$/,"")){if(!this.get("navigateOnHash"))return!1;b.hash=e}"replace"in b||(b.replace=a===c);this.get("html5")||b.force?this.fire("navigate",b):b.replace?f&&f.location.replace(a):
f&&(f.location=a);return!0},_normalizePath:function(a){var b,c,e,d,f;if(!a||"/"===a)return"/";e=a.split("/");f=[];b=0;for(c=e.length;b<c;++b)d=e[b],".."===d?f.pop():d&&f.push(d);b="/"+f.join("/");"/"!==b&&"/"===a.charAt(a.length-1)&&(b+="/");return b},_pjaxBindUI:function(){this._pjaxEvents||(this._pjaxEvents=d.one("body").delegate("click",this._onLinkClick,this.get("linkSelector"),this))},_resolvePath:function(a){return!a?this._getPath():"/"===a.charAt(0)?this._normalizePath(a):this._normalizePath(this._getRoot()+
a)},_resolveURL:function(a){var b=a&&a.match(this._regexURL),c,e;if(!b)return this._getURL();c=b[1];a=b[2];e=b[3];b=b[4];if(c)return 0===c.indexOf("//")&&(c=d.getLocation().protocol+c),c+(a||"/")+(e||"")+(b||"");c=this._getOrigin()+this._resolvePath(a);if(a||e)return c+(e||"")+(b||"");e=this._getQuery();return c+(e?"?"+e:"")+(b||"")},_defNavigateFn:function(a){this[a.replace?"replace":"save"](a.url);f&&this.get("scrollToTop")&&setTimeout(function(){f.scroll(0,0)},1)},_onLinkClick:function(a){var b;
1!==a.button||a.ctrlKey||a.metaKey||(b=a.currentTarget.get("href"))&&this._navigate(b,{originEvent:a})&&a.preventDefault()}};g.ATTRS={linkSelector:{value:"a."+h,writeOnce:"initOnly"},navigateOnHash:{value:!1},scrollToTop:{value:!0}};d.PjaxBase=g},"3.5.1",{requires:["classnamemanager","node-event-delegate","router"]});
