YUI.add("dataschema-xml",function(i){var j=i.Lang,k={1:!0,9:!0,11:!0},e;e={apply:function(a,b){var c={results:[],meta:{}};b&&k[b.nodeType]&&a?(c=e._parseResults(a,b,c),c=e._parseMeta(a.metaFields,b,c)):c.error=Error("XML schema parse failure");return c},_getLocationValue:function(a,b){var c=a.locator||a.key||a,d=b.ownerDocument||b,h,f,g=null;try{for(h=e._getXPathResult(c,b,d);f=h.iterateNext();)g=f.textContent||f.value||f.text||f.innerHTML||null;return i.DataSchema.Base.parse.call(this,g,a)}catch(j){}return null},
_getXPathResult:function(a,b,c){if(j.isUndefined(c.evaluate)){var d=[],h=a.split(/\b\/\b/),f=0,g=h.length,e;try{c.setProperty("SelectionLanguage","XPath"),d=b.selectNodes(a)}catch(k){for(;f<g&&b;f++)if(a=h[f],-1<a.indexOf("[")&&-1<a.indexOf("]"))a=a.slice(a.indexOf("[")+1,a.indexOf("]")),a--,b=b.children[a],e=!0;else if(-1<a.indexOf("@"))b=(a=a.substr(a.indexOf("@")))?b.getAttribute(a.replace("@","")):b;else if(-1<a.indexOf("//"))a=b.getElementsByTagName(a.substr(2)),b=a.length?a[a.length-1]:null;
else if(g!=f+1)for(c=b.childNodes.length-1;0<=c;c-=1)a===b.childNodes[c].tagName&&(b=b.childNodes[c],c=-1);b&&(j.isString(b)?d[0]={value:b}:e?d[0]={value:b.innerHTML}:d=i.Array(b.childNodes,0,!0))}return{index:0,iterateNext:function(){if(!(this.index>=this.values.length)){var a=this.values[this.index];this.index+=1;return a}},values:d}}return c.evaluate(a,b,c.createNSResolver(b.ownerDocument?b.ownerDocument.documentElement:b.documentElement),0,null)},_parseField:function(a,b,c){var d=a.key||a,h;a.schema?
(h={results:[],meta:{}},h=e._parseResults(a.schema,c,h),b[d]=h.results):b[d]=e._getLocationValue(a,c)},_parseMeta:function(a,b,c){if(j.isObject(a)){var d,b=b.ownerDocument||b;for(d in a)a.hasOwnProperty(d)&&(c.meta[d]=e._getLocationValue(a[d],b))}return c},_parseResult:function(a,b){var c={},d;for(d=a.length-1;0<=d;d--)e._parseField(a[d],c,b);return c},_parseResults:function(a,b,c){if(a.resultListLocator&&j.isArray(a.resultFields)){var d=b.ownerDocument||b,h=a.resultFields,f=[],g=0;if(a.resultListLocator.match(/^[:\-\w]+$/)){b=
b.getElementsByTagName(a.resultListLocator);for(g=b.length-1;0<=g;--g)f[g]=e._parseResult(h,b[g])}else for(b=e._getXPathResult(a.resultListLocator,b,d);a=b.iterateNext();)f[g]=e._parseResult(h,a),g+=1;f.length?c.results=f:c.error=Error("XML schema result nodes retrieval failure")}return c}};i.DataSchema.XML=i.mix(e,i.DataSchema.Base)},"3.5.1",{requires:["dataschema-base"]});
